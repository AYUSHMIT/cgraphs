\NeedsTeXFormat{LaTeX2e}[1999/12/01]
\ProvidesPackage{actris}

\newcommand{\Comment}[1]{\texttt{\color{gray}(*\ #1\ *)}}

\renewcommand{\textdom}[1]{\mathsf{#1}} % Override Iris's macros to be sans serif instead of italic

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% MATH SYMBOLS & NOTATION & IDENTIFIERS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Types
\newcommand{\Type}{\textdom{Type}}
\newcommand{\tvar}{T}
\newcommand{\tvarB}{U}
\newcommand{\tvarC}{V}
\newcommand{\bool}{\mathbb{B}}
\newcommand{\integer}{\mathbb{Z}}
\newcommand{\String}{\mathsf{String}}
% \newcommand{\List}{\mathsf{List}}
\newcommand{\MultiSet}{\mathsf{MultiSet}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% LANGUAGE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\Chan}{\textdom{Chan}}
\newcommand{\chan}{c}

\newcommand{\newchan}{\langkw{new\_chan}\ \TT}
\newcommand{\send}[2]{\langkw{send}\ #1\ #2}
\newcommand{\recv}[1]{\langkw{recv}\ #1}
\newcommand{\start}[1]{\langkw{start}\ {#1}}
\newcommand{\tryrecv}[1]{\langkw{try\_recv}\ #1}

\newcommand{\leftname}{\defemph{left}}
\newcommand{\rightname}{\defemph{right}}

\newcommand{\select}[2]{\langkw{select}\ #1\ #2}
\newcommand{\branch}[5]{
  \langkw{branch}\ #1\ \langkw{with}\ #2 \Rightarrow #3\ \vert\ #4\ \Rightarrow #5\ \langkw{end}}
\newcommand{\branchA}[3]{\branch{#1}{\leftname}{#2}{\rightname}{#3}}
\newcommand{\branchB}[3]{\branch{#1}{\rightname}{#3}{\leftname}{#2}}
\newcommand{\mbranch}[5]{
  \begin{array}[t]{@{}l@{}}
    \langkw{branch}\ #1\ \langkw{with}\\
    \begin{array}[t]{@{}l @{\;\Rightarrow\;} l@{}}
    \ \ #2 & #3 \\
    \vert\ #4 & #5 \\
    \end{array}\\
    \langkw{end}
  \end{array}}
\newcommand{\mbranchA}[3]{\mbranch{#1}{\leftname}{#2}{\rightname}{#3}}
\newcommand{\mbranchB}[3]{\mbranch{#1}{\rightname}{#3}{\leftname}{#2}}

\newcommand{\mbranchnlA}[5]{
\begin{array}[t]{@{}l@{}}
    \langkw{branch}\ #1\ \langkw{with}\\
    \begin{array}[t]{@{}l @{\;\Rightarrow\;}l}
    \ \ #2 & #3 \\
    \vert\ #4 & \ \\
    \multicolumn{2}{@{}l@{}}{\quad{#5}}
    \end{array}\\
    \langkw{end}
\end{array}
}
\newcommand{\mbranchC}[3]{\mbranchnlA{#1}{\leftname}{#2}{\rightname}{#3}}
\newcommand{\mbranchD}[3]{\mbranchnlA{#1}{\rightname}{#3}{\leftname}{#2}}

\newcommand{\mbranchnlB}[5]{
\begin{array}[t]{@{}l@{}}
    \langkw{branch}\ #1\ \langkw{with}\\
    \begin{array}[t]{@{}l @{\;\Rightarrow\;}l}
    \ \ #2 & \ \\
    \multicolumn{2}{@{}l@{}}{\quad\quad{#3}} \\
    \vert\ #4 & #5 \\
    \end{array}\\
    \langkw{end}
\end{array}
}
\newcommand{\mbranchE}[3]{\mbranchnlB{#1}{\leftname}{#2}{\rightname}{#3}}
\newcommand{\mbranchF}[3]{\mbranchnlB{#1}{\rightname}{#3}{\leftname}{#2}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% LOGIC
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Protocols

\newcommand{\prot}{\mathit{prot}}
\newcommand{\iProto}{\textdom{iProto}}

\newcommand{\SEND}{\textnormal{\bf !}}
\newcommand{\RECV}{\textnormal{\bf ?}}

\newcommand{\genprotHead}[4]{#1\, #2 \ifthenelse{\equal{#2}{}}{}{\,} \langle #3\rangle \curlybracket{#4}}
\newcommand{\genprotTHead}[3]{#1\, #2 \ifthenelse{\equal{#2}{}}{}{\,} \langle #3\rangle}
\newcommand{\genprot}[4]{\genprotHead{#1}{#2}{#3}{#4}.\,}
\newcommand{\genprotT}[3]{\genprotTHead{#1}{#2}{#3}.\,}

\newcommand{\sendprotHead}[3]{\genprotHead{\SEND}{#1}{#2}{#3}}
\newcommand{\recvprotHead}[3]{\genprotHead{\RECV\!}{#1}{#2}{#3}}
\newcommand{\sendprot}[3]{\genprot{\SEND}{#1}{#2}{#3}}
\newcommand{\recvprot}[3]{\genprot{\RECV\!}{#1}{#2}{#3}}
\newcommand{\sendprotT}[2]{\genprotT{\SEND}{#1}{#2}}
\newcommand{\recvprotT}[2]{\genprotT{\RECV\!}{#1}{#2}}

\newcommand{\protend}{\stend}
\newcommand{\protappop}{\cdot}
\newcommand{\protapp}[2]{#1 \protappop #2}
\newcommand{\dual}[1]{\overline{#1}}

\newcommand{\styp}{S}
\newcommand{\stsend}[1]{\SEND{#1}.}
\newcommand{\strecv}[1]{\RECV{#1}.}
\newcommand{\stend}{\mathbf{end}}
\newcommand{\subtypeop}{<:}
\newcommand{\subtype}[3]{#2 \subtypeop_{#1} #3}

\newcommand{\selectop}{\mathop{\oplus}}
\newcommand{\branchop}{\mathop{\&}}
\newcommand{\choiceprot}[3]{#1 #2 #3}
\newcommand{\mchoiceprot}[3]{
  #1 \\
  \quad #2\\
  #3}
\newcommand{\choiceprotprop}[5]{#1\ {}_{\{#2\}} {#3}_{\{#4\}}\ #5}
\newcommand{\choiceprotpropl}[4]{#1\ {}_{\{#2\}} {#3}\ #4}
\newcommand{\choiceprotpropr}[4]{#1\ {#2}_{\{#3\}}\ #4}
%\newcommand{\selectbranchprotprop}[5]{#1 {#2}#3{#4} #5}
\newcommand{\mchoiceprotprop}[5]{
  #1 \\
  \quad {}_{\{#2\}} {#3}_{\{#4\}} \\[0.4em]
  #5
  }
\newcommand{\selectprotprop}[4]{\choiceprotprop{#1}{#2}{\selectop}{#3}{#4}}
\newcommand{\mselectprotprop}[4]{\mselectbranchprotprop{#1}{#2}{\selectop}{#3}{#4}}
\newcommand{\branchprotprop}[4]{\choiceprotprop{#1}{#2}{\branchop}{#3}{#4}}
\newcommand{\branchprotpropl}[3]{\choiceprotpropl{#1}{#2}{\branchop}{#3}}
\newcommand{\branchprotpropr}[3]{\choiceprotpropr{#1}{\branchop}{#2}{#3}}
\newcommand{\mbranchprotprop}[4]{\mchoiceprotprop{#1}{#2}{\branchop}{#3}{#4}}
\newcommand{\selectprot}[2]{\choiceprot{#1}{\selectop}{#2}}
\newcommand{\mselectprot}[2]{\mchoiceprot{#1}{\selectop}{#2}}
\newcommand{\branchprot}[2]{\choiceprot{#1}{\branchop}{#2}}
\newcommand{\mbranchprot}[2]{\mchoiceprot{#1}{\branchop}{#2}}

\newcommand{\interp}[2]{#1 \rightarrowtail #2}

%% Subprotocols

\newcommand{\subprotop}{\sqsubseteq}
\newcommand{\subprot}[2]{#1 \subprotop #2}
\newcommand{\spacedsubprot}[2]{#1 \ \subprotop\  #2}
\newcommand{\protne}{\widehat{\prot}}

%% Other

\newcommand{\ipropR}{R}
